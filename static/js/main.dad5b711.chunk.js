(this.webpackJsonplandchat=this.webpackJsonplandchat||[]).push([[0],{112:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(10),o=n.n(r),i=n(30),s=n(12),l=n(28),j=n(34),d={title:"LandChat NG",endpoint:"https://lc.hywiki.xyz/api/v1"},b=n(148),h=n(149),u=n(62),p=n(168),m=n(151),O=n(152),x=n(153),g=n(154),f=n(155),v=n(171),y=n(156),w=n(157),k=n(158),S=n(159),C=n(160),F=n(161),I=n(162),N=n(163),D=n(164),R=n(170),_=n(165),q=n(166),B=n(147),L=n(16),E=n(85),H=n.n(E),z=n(84),M=n.n(z),P=n(32),G=n.n(P),J=n(83),T=n.n(J),U=n(82),V=n.n(U),W=n(61),Y=n(2),A=Object(B.a)((function(e){return{root:{display:"flex",position:"fixed",bottom:e.spacing(2),right:e.spacing(2)},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},chatForm:{},appBar:{zIndex:e.zIndex.drawer+1},drawer:{width:300,flexShrink:0},drawerPaper:{width:300},drawerContainer:{overflow:"auto"},content:{flexGrow:1,padding:e.spacing(3)}}}));function K(e){var t=e.endpoint,n=e.chatroom,c=Object(a.useState)({messages:[],timestamp:0}),r=Object(j.a)(c,2),o=r[0],i=r[1],s=Object(a.useState)(0),l=Object(j.a)(s,2),d=l[0],u=l[1],p=Object(a.useState)(-1),m=Object(j.a)(p,2),O=m[0],x=m[1],g=Object(W.b)().enqueueSnackbar,f=function(e,t){g(e,{variant:t})};function v(e){u(1),fetch(t+"/message_view",{method:"POST",body:"room="+encodeURIComponent(n)+"&lastid="+encodeURIComponent(-1),headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"})}).then((function(e){return e.json()})).catch((function(e){return f("Fetch failed: "+e,"error")})).then((function(t){return function(e,t){try{if(i(e),0!==t){var a=document.querySelector("#top-to-back-anchor");a&&a.scrollIntoView({behavior:"smooth",block:"center"}),f("Welcome to chatroom: "+n,"success"),e.length<1&&f("This chatroom doesn't exist.\nSend a message to create it.","info")}}catch(c){f("Failed to decode message: "+c,"error")}u(0)}(t,e)})).then((function(){x(setTimeout((function(){v(0)}),3e3))}))}return Object(a.useEffect)((function(){-1!==O&&clearTimeout(O),v(1);var e=JSON.parse(localStorage.recentRoom);e.rooms.length>=5&&e.rooms.shift();var t=new Date;e.rooms.unshift({name:n,date:t.getMonth()+1+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()}),localStorage.recentRoom=JSON.stringify(e)}),[n]),Object(Y.jsxs)("div",{children:[Object(Y.jsx)(b.a,{children:o.messages.map((function(e,t){return Object(Y.jsx)(X,{data:e},e.msgid)}))}),Object(Y.jsx)(h.a,{style:{display:d?"block":"none"}})]})}function Q(e){var t=Object(W.b)().enqueueSnackbar,n=e.endpoint,c=e.chatroom,r=Object(a.useState)(0),o=Object(j.a)(r,2),i=o[0],s=o[1];function l(e){for(var t=e+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){var c=n[a].trim();if(0===c.indexOf(t))return c.substring(t.length,c.length)}return""}var b=function(e,n){t(e,{variant:n})};function h(){var e=document.querySelector("#msginput-textarea").value,t=new FormData;t.append("room",c),t.append("id",l("lc_uid")),t.append("pwd",l("lc_passw")),t.append("msg",e),t.append("type",0),t.append("app_id","aI5qE5eL0gH1bD1pQ5tC1dC0cD0bF1"),fetch(n+"/message_send",{method:"POST",body:t}).then((function(e){return e.text()})).catch((function(e){return b("Fetch failed: "+e,"error")})).then((function(e){"Succeed"!==e?b(e,"warning"):(b("Message sent","success"),document.querySelector("#msginput-textarea").value="")}))}return Object(Y.jsx)("div",{children:Object(Y.jsxs)("form",{id:"msginput-form",children:[Object(Y.jsxs)(u.a,{variant:"body1",children:["Send message at chatroom: ",c]}),Object(Y.jsx)(p.a,{id:"msginput-textarea",label:"Input Message",placeholder:"Press Ctrl+Space to send",multiline:!0,margin:"normal",fullWidth:!0,variant:"filled",maxLength:1500,onKeyDown:function(e){var t=e||window.event;13===t.keyCode&&t.ctrlKey&&h()}}),Object(Y.jsx)(m.a,{variant:"contained",color:"primary",onClick:h,children:"Send"}),Object(Y.jsx)("input",{accept:"image/*",id:"upload-pic",type:"file",style:{display:"none"},onChange:function(){s(1);var e=document.querySelector("#upload-pic").files,t=new FormData;t.append("from",d.title),t.append("image",e[0]),fetch("https://pic.hywiki.xyz/api/upload",{method:"POST",body:t}).then((function(e){return e.json()})).catch((function(e){return b("Fetch failed: "+e,"error")})).then((function(e){e.code/100===2?function(e){var t=new FormData;t.append("room",c),t.append("id",l("lc_uid")),t.append("pwd",l("lc_passw")),t.append("msg",e),t.append("type",1),t.append("app_id","aI5qE5eL0gH1bD1pQ5tC1dC0cD0bF1"),fetch(n+"/message_send",{method:"POST",body:t}).then((function(e){return e.text()})).catch((function(e){return b("Fetch failed: "+e,"error")})).then((function(e){"Succeed"!==e?b(e,"warning"):b("Message sent","success")}))}(e.data.url):b("Image upload failed: "+e.msg,"error"),s(0)}))}}),Object(Y.jsx)("label",{htmlFor:"upload-pic",children:Object(Y.jsx)(O.a,{color:"primary","aria-label":"upload picture",component:"span",children:Object(Y.jsx)(V.a,{})})}),Object(Y.jsx)(x.a,{size:20,style:i?{}:{display:"none"}})]})})}function X(e){var t=e.data;A();return Object(Y.jsxs)("div",{"data-msgid":t.msgid,children:[Object(Y.jsxs)(g.a,{alignItems:"flex-start",children:[Object(Y.jsx)(f.a,{children:Object(Y.jsx)(v.a,{src:t.picurl,style:{backgroundColor:function(e){for(var t="",n=0;n<e.length;n++)t+=parseInt(e[n].charCodeAt(0),10).toString(16);return"#"+t.slice(1,4)}(t.name)},children:t.name.substr(0,2)})}),Object(Y.jsx)(y.a,{primary:t.name,secondary:Object(Y.jsxs)(c.a.Fragment,{children:[function(e){switch(e.type){case 0:return function(e){return Object(Y.jsx)(c.a.Fragment,{children:Object(Y.jsxs)(u.a,{component:"span",variant:"body2",color:"textPrimary",style:{whiteSpace:"pre-wrap"},children:[e.content,Object(Y.jsx)("br",{})]})})}(e);case 1:return function(e){return Object(Y.jsxs)(c.a.Fragment,{children:[Object(Y.jsx)("a",{href:e.content,target:"_blank",children:Object(Y.jsx)("img",{src:e.content,height:100,alt:e.name,style:{maxHeight:100}})}),Object(Y.jsx)("br",{})]})}(e);default:return Object(Y.jsx)(c.a.Fragment,{children:"???"})}}(t),t.time+" @ "+t.app]})})]}),Object(Y.jsx)(w.a,{variant:"inset",component:"li"})]})}function Z(e){var t=e.children,n=e.window,a=e.direction,c=A(),r=Object(k.a)({target:n?n():void 0,disableHysteresis:!0,threshold:250});"back"===a&&(r=!r);var o=r;return Object(Y.jsx)(S.a,{in:o,children:Object(Y.jsx)("div",{onClick:function(e){var t=(e.target.ownerDocument||document).querySelector("back"==a?"#top-to-back-anchor":"#back-to-top-anchor");t&&t.scrollIntoView({behavior:"smooth",block:"center"})},role:"presentation",className:c.root,children:t})})}function $(e){var t=A();function n(e){for(var t="",n=0;n<e.length;n++)t+=parseInt(e[n].charCodeAt(0),10).toString(16);return"#"+t.slice(1,4)}return Object(Y.jsx)(c.a.Fragment,{children:Object(Y.jsx)("div",{className:t.drawerContainer,children:Object(Y.jsxs)(b.a,{children:[Object(Y.jsxs)(g.a,{button:!0,onClick:function(){window.location.hash="/"},children:[Object(Y.jsx)(C.a,{children:Object(Y.jsx)(G.a,{})}),Object(Y.jsx)(y.a,{primary:"Home"})]}),Object(Y.jsx)(w.a,{}),Object(Y.jsx)(g.a,{children:"Recent Rooms"}),JSON.parse(localStorage.recentRoom).rooms.map((function(e,t){return Object(Y.jsxs)(g.a,{alignItems:"flex-start",button:!0,onClick:function(){var t=e.name;if(""!==t)return window.location.hash="/chat/"+encodeURIComponent(t),!1},children:[Object(Y.jsx)(f.a,{children:Object(Y.jsx)(v.a,{style:{backgroundColor:n(e.name)},children:e.name.substr(0,2)})}),Object(Y.jsx)(y.a,{primary:e.name,secondary:Object(Y.jsx)(c.a.Fragment,{children:e.date})})]},t)}))]})})})}var ee=n(150),te=(n(75),Object(B.a)((function(e){return{root:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2)},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},link:{color:"hsla(0,0%,100%,.87)",textDecoration:"none","&:hover":{textDecoration:"underline"}}}})));var ne=Object(B.a)((function(e){return{root:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2)},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},signupLink:{color:"hsla(0,0%,100%,.87)",textDecoration:"none","&:hover":{textDecoration:"underline"}}}}));var ae=Object(B.a)((function(e){return{root:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2)},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));var ce=n(86),re=n(60),oe=n(167);localStorage.recentRoom||(localStorage.recentRoom='{"rooms": []}');var ie=Object(ce.a)({palette:{type:"dark",primary:re.a,secondary:oe.a}}),se=document.getElementById("root");o.a.render(Object(Y.jsx)(a.StrictMode,{children:Object(Y.jsx)(F.a,{theme:ie,children:Object(Y.jsx)(i.a,{children:Object(Y.jsxs)(s.c,{children:[Object(Y.jsx)(s.a,{path:"/",exact:!0,component:function(e){var t=te(),n=Object(L.a)(),r=Object(a.useState)(0),o=Object(j.a)(r,2),s=o[0],l=o[1];return Object(a.useEffect)((function(){"undefined"===typeof Storage&&(alert("You have to enable Local Storage of your browser to run this application. If you can't do it, please update your browser to Chrome 4.0+, MS Edge 8.0+, Firefox 3.5+, Safari 4.0+ or Opera 11.5+."),console.error("You have to enable Local Storage of your browser to run this application. If you can't do it, please update your browser to Chrome 4.0+, MS Edge 8.0+, Firefox 3.5+, Safari 4.0+ or Opera 11.5+.")),-1!=function(e){for(var t=e+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){var c=n[a].trim();if(0===c.indexOf(t))return c.substring(t.length,c.length)}return""}("lc_debug").indexOf("DEBUG")&&l(1)})),Object(Y.jsx)(c.a.Fragment,{children:Object(Y.jsxs)(F.a,{theme:n,children:[Object(Y.jsx)(I.a,{}),Object(Y.jsx)(N.a,{position:"sticky",children:Object(Y.jsxs)(D.a,{children:[Object(Y.jsx)(O.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",onClick:function(){window.location.hash="/"},children:Object(Y.jsx)(G.a,{})}),Object(Y.jsx)(u.a,{variant:"h5",children:d.title})]})}),Object(Y.jsx)(D.a,{id:"back-to-top-anchor"}),Object(Y.jsxs)(_.a,{children:[Object(Y.jsx)(u.a,{variant:"h3",component:"h1",children:"Welcome to LandChat!"}),Object(Y.jsx)("br",{}),Object(Y.jsxs)("div",{id:"roomselect",children:[Object(Y.jsx)(u.a,{variant:"body1",component:"p",children:"Enter the name of the room you want to join:"}),Object(Y.jsx)("br",{}),Object(Y.jsx)("div",{children:Object(Y.jsxs)(ee.a,{variant:"outlined",children:[Object(Y.jsx)(p.a,{type:"text",id:"roomselect-input",label:"Room name",name:"roomname",variant:"outlined",required:!0}),Object(Y.jsx)(m.a,{variant:"contained",color:"primary",onClick:function(){var e=document.querySelector("#roomselect-input").value;if(""!==e){window.location.hash="/chat/"+encodeURIComponent(e);var t=JSON.parse(localStorage.recentRoom);t.rooms.length>=5&&t.rooms.shift();var n=new Date;return t.rooms[t.rooms.length]={name:e,date:n.getMonth()+1+"-"+n.getDate()+" "+n.getHours()+":"+n.getMinutes()},localStorage.recentRoom=JSON.stringify(t),!1}},children:"Join"})]})})]}),Object(Y.jsxs)("div",{style:{display:s?"none":"block"},children:[Object(Y.jsx)("br",{}),Object(Y.jsxs)(u.a,{variant:"body1",children:["You haven't logged in yet. Please"," ",Object(Y.jsx)(i.b,{to:"/login",className:t.link,children:"click here"})," ","to login or sign up first.",Object(Y.jsx)("br",{})]})]}),Object(Y.jsxs)("div",{children:[Object(Y.jsx)("br",{}),Object(Y.jsx)(u.a,{variant:"h4",component:"h2",children:"\u516c\u544a"}),Object(Y.jsxs)(u.a,{variant:"body1",children:[Object(Y.jsx)("br",{}),"LandChat NG \u66f4\u65b0\u5185\u5bb9"]}),Object(Y.jsxs)(u.a,{variant:"body2",children:["\u7248\u672c0.3.0.dev4",Object(Y.jsx)("br",{}),Object(Y.jsxs)("ul",{children:[Object(Y.jsx)("li",{children:"\u53d1\u9001\u56fe\u7247\u652f\u6301\uff1b"}),Object(Y.jsx)("li",{children:"Ctrl+Enter\u53d1\u9001\u652f\u6301\uff1b"}),Object(Y.jsx)("li",{children:"\u6df1\u8272\u6a21\u5f0f\uff1b"}),Object(Y.jsx)("li",{children:"\u6d88\u606f\u53d1\u9001\u903b\u8f91\u4f18\u5316\uff1b"}),Object(Y.jsx)("li",{children:"\u8fb9\u680f\u652f\u6301\uff0c\u9996\u9875\u53bb\u9664\u6700\u8fd1\u804a\u5929\u5ba4\uff1b"}),Object(Y.jsx)("li",{children:"Bug\u4fee\u590d\u3002"})]}),"\u4e0b\u6b21\u66f4\u65b0\u9884\u544a:",Object(Y.jsx)("br",{}),Object(Y.jsxs)("ul",{children:[Object(Y.jsx)("li",{children:"\u53ef\u4ee5\u4fee\u6539\u5bc6\u7801\uff0c\u6635\u79f0\uff0c\u5934\u50cf\uff1b"}),Object(Y.jsx)("li",{children:"\u6d88\u606f\u66f4\u65b0\u95f4\u9694\u7f29\u77ed\u52301s\uff1b"}),Object(Y.jsx)("li",{children:"\u5373\u5c06\u8fce\u6765\u9996\u4e2a\u7a33\u5b9a\u7248\u672c\u3002"})]}),"\u5982\u679c\u60a8\u611f\u5174\u8da3\u53ef\u4ee5\u8bd5\u8bd5\u5f00\u53d1env:\xa0",Object(Y.jsx)("a",{href:"https://dev.lc.hywiki.xyz/#/",className:t.link,children:"https://dev.lc.hywiki.xyz"}),Object(Y.jsx)("br",{}),"\u91cc\u9762\u4f60\u53ef\u4ee5\u5b9e\u65f6\u770b\u5230564\u7684\u5f00\u53d1\u8fdb\u5c55\uff0c\u4f46\u52a0\u8f7d\u6162\uff0c\u4e0d\u7a33\u5b9a\uff0c\u53ef\u80fd\u968f\u65f6\u4f1a\u6302\u3002",Object(Y.jsx)("br",{}),Object(Y.jsx)("br",{})]})]})]})]})})}}),Object(Y.jsx)(s.a,{path:"/login",component:function(e){var t=ne(),n=Object(L.a)();function a(e){for(var t=e+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){var c=n[a].trim();if(0===c.indexOf(t))return c.substring(t.length,c.length)}return""}return""!==a("lc_debug")&&""!==a("lc_uid")&&(window.location.hash="/"),Object(Y.jsx)(c.a.Fragment,{children:Object(Y.jsxs)(F.a,{theme:n,children:[Object(Y.jsx)(I.a,{}),Object(Y.jsx)(N.a,{position:"sticky",children:Object(Y.jsxs)(D.a,{children:[Object(Y.jsx)(O.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",onClick:function(){window.location.hash="/"},children:Object(Y.jsx)(G.a,{})}),Object(Y.jsx)(u.a,{variant:"h5",children:d.title})]})}),Object(Y.jsx)(D.a,{id:"back-to-top-anchor"}),Object(Y.jsxs)(_.a,{children:[Object(Y.jsx)(u.a,{variant:"h3",component:"h1",children:"Login"}),Object(Y.jsxs)("form",{noValidate:!0,autoComplete:"off",action:d.endpoint+"/user_login",method:"post",children:[Object(Y.jsx)("br",{}),Object(Y.jsx)(p.a,{type:"text",id:"login-user",label:"Username or email",name:"usr",variant:"outlined",required:!0}),Object(Y.jsx)("br",{}),Object(Y.jsx)("br",{}),Object(Y.jsx)(p.a,{type:"password",id:"login-pswd",label:"Password",name:"pwd",variant:"outlined",required:!0}),Object(Y.jsx)("br",{}),Object(Y.jsx)("br",{}),Object(Y.jsx)(m.a,{id:"login-btn",variant:"contained",color:"primary",type:"submit",children:"Login"})]}),Object(Y.jsx)("br",{}),Object(Y.jsxs)(u.a,{component:"p",children:["If you don't have an account, please"," ",Object(Y.jsx)("a",{href:"https://lc.hywiki.xyz/lc_signup.php",className:t.signupLink,children:"click here"})," to sign up."]})]})]})})}}),Object(Y.jsx)(s.a,{path:"/chat/:room",component:function(e){var t=e.match.params.room,n=A(),r=Object(L.a)(),o=c.a.useState(!1),i=Object(j.a)(o,2),s=i[0],b=i[1],h=function(){b(!1)};return Object(a.useEffect)((function(){var e=document.querySelector("#top-to-back-anchor");e&&e.scrollIntoView({behavior:"smooth",block:"center"})})),Object(Y.jsx)(c.a.Fragment,{children:Object(Y.jsx)(W.a,{maxSnack:5,autoHideDuration:3e3,children:Object(Y.jsxs)(F.a,{theme:r,children:[Object(Y.jsx)(I.a,{}),Object(Y.jsx)(N.a,{position:"sticky",className:n.appBar,children:Object(Y.jsxs)(D.a,{children:[Object(Y.jsx)(O.a,{edge:"start",className:n.menuButton,color:"inherit","aria-label":"Home",onClick:function(){b(!0)},children:Object(Y.jsx)(T.a,{})}),Object(Y.jsx)(u.a,{variant:"h5",children:d.title})]})}),Object(Y.jsx)(D.a,{id:"back-to-top-anchor"}),Object(Y.jsx)(R.a,{className:n.drawer,classes:{paper:n.drawerPaper},anchor:"left",open:s,onClose:h,onClick:h,children:Object(Y.jsx)($,{})}),Object(Y.jsxs)(_.a,{id:"chatarea",className:n.content,children:[Object(Y.jsx)(K,Object(l.a)(Object(l.a)({},e),{},{endpoint:d.endpoint,chatroom:t})),Object(Y.jsx)("br",{}),Object(Y.jsx)(Q,Object(l.a)(Object(l.a)({},e),{},{endpoint:d.endpoint,chatroom:t,className:n.chatForm})),Object(Y.jsx)(D.a,{id:"top-to-back-anchor"})]}),Object(Y.jsx)(Z,Object(l.a)(Object(l.a)({direction:"back"},e),{},{children:Object(Y.jsx)(q.a,{color:"secondary",size:"small","aria-label":"scroll to bottom",children:Object(Y.jsx)(M.a,{})})})),Object(Y.jsx)(Z,Object(l.a)(Object(l.a)({direction:"top"},e),{},{children:Object(Y.jsx)(q.a,{color:"secondary",size:"small","aria-label":"scroll back to top",children:Object(Y.jsx)(H.a,{})})}))]})})})}}),Object(Y.jsx)(s.a,{path:"*",component:function(e){var t=ae(),n=Object(L.a)();return Object(Y.jsx)(c.a.Fragment,{children:Object(Y.jsxs)(F.a,{theme:n,children:[Object(Y.jsx)(I.a,{}),Object(Y.jsx)(N.a,{position:"sticky",children:Object(Y.jsxs)(D.a,{children:[Object(Y.jsx)(O.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",onClick:function(){window.location.hash="/"},children:Object(Y.jsx)(G.a,{})}),Object(Y.jsx)(u.a,{variant:"h5",children:d.title})]})}),Object(Y.jsx)(D.a,{id:"back-to-top-anchor"}),Object(Y.jsxs)(_.a,{children:[Object(Y.jsx)(u.a,{variant:"h3",component:"h1",children:"404 Not Found"}),Object(Y.jsxs)(u.a,{variant:"p",children:["Uh oh..",Object(Y.jsx)("br",{}),"We cannot find the page you want.",Object(Y.jsx)("br",{}),Object(Y.jsx)(i.b,{to:"/",children:"Go back to Homepage."})]})]})]})})}})]})})})}),se)}},[[112,1,2]]]);
//# sourceMappingURL=main.dad5b711.chunk.js.map